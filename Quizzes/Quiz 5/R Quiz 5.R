##############
# Question 1 #
##############

matrix = matrix(c(2,1,-3,1,1,0,4,-2,-3,4,-1,0,1,-2,0,5), nrow=4, ncol=4, byrow=TRUE)
print(matrix)

#       [,1] [,2] [,3] [,4]
# [1,]    2    1   -3    1
# [2,]    1    0    4   -2
# [3,]   -3    4   -1    0
# [4,]    1   -2    0    5

eigen = eigen(matrix)
print(eigen)

# $values
# [1]  6.451322  3.448002  1.980310 -5.879634
# 
# $vectors
#         [,1]       [,2]       [,3]       [,4]
# [1,]  0.3179612 -0.6385084 -0.6000627  0.3621222
# [2,] -0.4084564  0.1075959 -0.6874392 -0.5907740
# [3,] -0.3472819  0.5274074 -0.3186140  0.7069101
# [4,]  0.7819587  0.5500651 -0.2565878 -0.1418862

for (i in c(1,2,3,4)) {
  
  print(
    
    sum((eigen$vectors[,i])^2)
    
  )

}

# [1] 1
# [1] 1
# [1] 1
# [1] 1

# EIGENVECTORS ARE ALREADY UNIT NORMAL

P = eigen$vectors
print(P)

#         [,1]       [,2]       [,3]       [,4]
# [1,]  0.3179612 -0.6385084 -0.6000627  0.3621222
# [2,] -0.4084564  0.1075959 -0.6874392 -0.5907740
# [3,] -0.3472819  0.5274074 -0.3186140  0.7069101
# [4,]  0.7819587  0.5500651 -0.2565878 -0.1418862

D = diag(eigen$values)
print(D)

#       [,1]     [,2]    [,3]      [,4]
# [1,] 6.451322 0.000000 0.00000  0.000000
# [2,] 0.000000 3.448002 0.00000  0.000000
# [3,] 0.000000 0.000000 1.98031  0.000000
# [4,] 0.000000 0.000000 0.00000 -5.879634

P_inverse = t(P)
print(P_inverse)

#         [,1]       [,2]       [,3]       [,4]
# [1,]  0.3179612 -0.4084564 -0.3472819  0.7819587
# [2,] -0.6385084  0.1075959  0.5274074  0.5500651
# [3,] -0.6000627 -0.6874392 -0.3186140 -0.2565878
# [4,]  0.3621222 -0.5907740  0.7069101 -0.1418862

##############
# Question 2 #
##############

y = c(43.1, 26.7, 32.8, 21.0, 42.2, 31.4, 42.8, 38.7, 37.9, 23.8, 24.2, 46.1, 39.5)
x = c(17.9, 8.9, 14.7, 5.4, 11.5, 13.4, 17.7, 13.6, 8.5, 7.3, 4.4, 16.8, 15.7)
intercept= rep(c(1), times=13)

a_matrix = matrix(c(intercept, x), ncol=2)
print(a_matrix)

#       [,1] [,2]
# [1,]    1 17.9
# [2,]    1  8.9
# [3,]    1 14.7
# [4,]    1  5.4
# [5,]    1 11.5
# [6,]    1 13.4
# [7,]    1 17.7
# [8,]    1 13.6
# [9,]    1  8.5
# [10,]    1  7.3
# [11,]    1  4.4
# [12,]    1 16.8
# [13,]    1 15.7

matrix_multiplication = solve(t(a_matrix) %*% a_matrix) %*% t(a_matrix) %*% y
print(matrix_multiplication)

# First entry is the "Beta 1" coefficient
# Second entry is the "Beta 0" coefficient
#         [,1]
# [1,] 16.465345
# [2,]  1.515729
